<link rel="import" href="bower_components/polymer/polymer.html">
<dom-module id="type-write-animation">
    <template>
        <style>
         :host {
            display: block;
            color: black;
        }
        </style>
        <!-- Element content -->
        <span style$="color:[[color]];">
            <span class="wrap" style$="border-right:[[cursorThicknes]]px solid; color:[[color]];">[[txt]]</span>
        </span>
    </template>
    <script>
    Polymer({
        is: 'type-write-animation',
        properties: {
            textArray: {
                type: Array,
                value: function() {
                    return ["The typewrite webcomponent", "Feel free to use & improve this element"]
                }
            },
            // Customization
            timeTillRemove: {
                type: Number,
                value: 800
            },

            timeTillWrite: {
                type: Number,
                value: 400
            },

            color: {
                type: String,
                value: '#334d5c'
            },

            writeSpeed: {
                type: Number,
                value: 80
            },

            removeSpeed: {
                type: Number,
                value: 3
            },

            cursorThicknes: {
                type: Number,
                value: 5
            },

            // Function related
            loopNum: {
                type: Number,
                value: 0
            },
            txt: {
                type: String,
                value: ''
            },
            isDeleting: {
                type: Boolean,
                value: false
            },
            fullTxt: {
                type: String
            }
        },

        attached: function() {
            if (this.textArray) {
                this.controllWrite();
            }
        },

        controllWrite: function() {
            var that = this;

            var i = this.loopNum % this.textArray.length;
            if (this.loopNum >= this.textArray.length) {
                this.loopNum = 0;
                var i = this.loopNum % this.textArray.length;
            }
            this.fullTxt = this.textArray[i];


            if (!this.isDeleting && this.txt === this.fullTxt) {
                // text is fully drawen start deletion
                setTimeout(function() {
                    that.isDeleting = true;
                    that.delete();
                    return
                }, this.timeTillRemove);

            } else if (this.isDeleting && this.txt === '') {
                // text is fully removed start drawing next
                setTimeout(function() {
                    that.isDeleting = false;
                    that.loopNum++;
                    that.write();
                    return
                }, this.timeTillWrite);

            } else if (this.isDeleting) {
                // not finished deleting go on
                if (this.removeSpeed <= 1) {
                    var instand = true;
                }
                setTimeout(function() {
                    that.delete(instand);
                    return
                }, this.removeSpeed);

            } else if (!this.isDeleting) {
                // not finished drawing go on
                setTimeout(function() {
                    that.write();
                    return
                }, this.writeSpeed);
            }
        },

        write: function() {
            if (!this.isDeleting) {
                this.txt = this.fullTxt.substring(0, this.txt.length + 1);
            }
            this.controllWrite();
        },

        delete: function(instand) {
            if (this.isDeleting) {
                if (instand == true) {
                    this.txt = '';
                } else {
                    this.txt = this.fullTxt.substring(0, this.txt.length - 1);
                }
            }
            this.controllWrite();
        }

    });
    </script>
</dom-module>